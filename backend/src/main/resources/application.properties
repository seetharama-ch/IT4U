# ==========================
# IT4U - Single Environment Config
# ==========================
spring.application.name=it4u
server.port=8060
server.forward-headers-strategy=framework

# Public URL (for notifications/CORS)
app.public-url=${APP_PUBLIC_URL:https://gsg-mecm}

# --------------------------
# Database (PostgreSQL)
# --------------------------
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/it4u}
spring.datasource.username=${DB_USER:it4u_user}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA / Hibernate
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.open-in-view=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# --------------------------
# Session Configuration
# --------------------------
server.servlet.session.timeout=30m
server.servlet.session.cookie.path=/
server.servlet.session.cookie.http-only=true
# Use Lax for prod/host compatibility
server.servlet.session.cookie.same-site=Lax

# --------------------------
# Security / Auth
# --------------------------
# Mode: local or azure
it4u.auth.mode=${AUTH_MODE:azure}

# Azure AD
spring.security.oauth2.client.registration.azure.client-id=${AZURE_CLIENT_ID}
spring.security.oauth2.client.registration.azure.client-secret=${AZURE_CLIENT_SECRET}
spring.security.oauth2.client.registration.azure.scope=openid,profile,email
spring.security.oauth2.client.registration.azure.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.azure.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}
spring.security.oauth2.client.provider.azure.issuer-uri=https://login.microsoftonline.com/${AZURE_TENANT_ID}/v2.0
spring.security.oauth2.client.provider.azure.user-name-attribute=name

# --------------------------
# Mail (Microsoft 365 SMTP)
# --------------------------
spring.mail.host=smtp.office365.com
spring.mail.port=587
spring.mail.username=it4u-notify@geosoftglobal.com
spring.mail.password=${MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=10000
spring.mail.properties.mail.smtp.timeout=10000
spring.mail.properties.mail.smtp.writetimeout=10000
spring.mail.default-encoding=UTF-8

# Notification Settings
it4u.mail.enabled=true
notifications.email-enabled=true
notifications.sender-address=it4u-notify@geosoftglobal.com
notifications.it-support-group=${NOTIFICATIONS_IT_SUPPORT_GROUP:itsupport@company.com}
notifications.admin-group=${NOTIFICATIONS_ADMIN_GROUP:itadmin@company.com}

# --------------------------
# Attachments
# --------------------------
it4u.attachments.base-path=${ATTACHMENTS_PATH:D:/IT4U/storage/attachments}
it4u.attachments.max-size-bytes=2097152
it4u.attachments.allowed-content-types=application/pdf,text/plain,image/png,image/jpeg,image/webp

spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=10MB

# --------------------------
# Actuator
# --------------------------
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when_authorized

# --------------------------
# Logging
# --------------------------
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=INFO
logging.level.com.gsg.it4u=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} [cid=%X{cid}] - %msg%n

# --------------------------
# Misc
# --------------------------
it4u.bootstrap.forceResetPasswords=false
spring.h2.console.enabled=false
it4u.reset.enabled=true
notifications.enabled=true
